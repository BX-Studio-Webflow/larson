"use strict";(()=>{var b=Object.defineProperty;var h=(s,e,t)=>e in s?b(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var i=(s,e,t)=>h(s,typeof e!="symbol"?e+"":e,t);var g=localStorage.getItem("devMode")==="true",f=g?"http://localhost:8000/api/jobs":"https://larson-server.vercel.app/api/jobs",v=4,r={container:'[dev-role="job-container"]',filtersWrapper:'[dev-role="job-filters-wrapper"]',filterTag:'[dev-target="job-filter-tag"]',filterText:'[dev-target="job-filter-text"]',jobList:'[dev-target="job-list"]',jobCard:'[dev-target="one-job-card"]',jobTitle:'[dev-role="job-title"]',jobDesc:'[dev-role="job-desc"]',jobCategory:'[dev-target="job-category"]',jobCta:'[dev-target="job-cta"]',paginationWrapper:'[dev-role="job-pagination-wrapper"]',btnPrev:'[dev-target="btn-prev"]',btnNext:'[dev-target="btn-next"]',pageBtnTemplate:'[dev-target="page-btn-template"]',featuredJobList:'[dev-target="job-list-featured"]',featuredJobCard:'[dev-target="featured-job-card"]',featuredJobTitle:'[dev-target="featured-job-title"]',featuredJobDesc:'[dev-target="featured-job-desc"]',featuredJobCategory:'[dev-target="featured-job-category"]',featuredJobCta:'[dev-target="featured-job-cta"]'},p=class{constructor(){i(this,"jobs",[]);i(this,"filteredJobs",[]);i(this,"currentPage",1);i(this,"currentFilter",null);i(this,"departments",[]);i(this,"container",null);i(this,"filtersWrapper",null);i(this,"filterTemplate",null);i(this,"jobList",null);i(this,"jobCardTemplate",null);i(this,"paginationWrapper",null);i(this,"btnPrev",null);i(this,"btnNext",null);i(this,"pageBtnTemplate",null);i(this,"pageBtnWrapper",null);i(this,"featuredJobList",null);i(this,"featuredJobCardTemplate",null)}async init(){this.queryElements()&&(this.bindEvents(),await this.loadJobs())}queryElements(){return this.container=document.querySelector(r.container),this.container?(this.filtersWrapper=document.querySelector(r.filtersWrapper),this.filtersWrapper?(this.filterTemplate=document.querySelector(r.filterTag),this.filterTemplate?(this.jobList=document.querySelector(r.jobList),this.jobList?(this.jobCardTemplate=document.querySelector(r.jobCard),this.jobCardTemplate?(this.paginationWrapper=document.querySelector(r.paginationWrapper),this.paginationWrapper?(this.btnPrev=document.querySelector(r.btnPrev),this.btnPrev?(this.btnNext=document.querySelector(r.btnNext),this.btnNext?(this.pageBtnTemplate=document.querySelector(r.pageBtnTemplate),this.pageBtnTemplate?(this.pageBtnWrapper=this.pageBtnTemplate.parentElement,this.pageBtnWrapper?(this.featuredJobList=document.querySelector(r.featuredJobList),this.featuredJobCardTemplate=document.querySelector(r.featuredJobCard),this.featuredJobList&&!this.featuredJobCardTemplate&&console.error('[JobBoard] Missing required attribute: dev-target="featured-job-card"'),!0):(console.error("[JobBoard] Page button template must have a parent wrapper"),!1)):(console.error('[JobBoard] Missing required attribute: dev-target="page-btn-template"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-target="btn-next"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-target="btn-prev"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-role="job-pagination-wrapper"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-target="one-job-card"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-target="job-list"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-target="job-filter-tag"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-role="job-filters-wrapper"'),!1)):(console.error('[JobBoard] Missing required attribute: dev-role="job-container"'),!1)}bindEvents(){this.btnPrev?.addEventListener("click",()=>this.goToPage(this.currentPage-1)),this.btnNext?.addEventListener("click",()=>this.goToPage(this.currentPage+1))}async loadJobs(){try{let e=await fetch(f);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);this.jobs=await e.json()}catch(e){console.error("[JobBoard] Failed to fetch jobs:",e);return}this.extractDepartments(),this.renderFeaturedJobs(),this.renderFilters(),this.applyFilter(null)}renderFeaturedJobs(){if(!this.featuredJobList||!this.featuredJobCardTemplate)return;this.featuredJobList.innerHTML="",[...this.jobs].sort((t,a)=>new Date(a.postedDate).getTime()-new Date(t.postedDate).getTime()).slice(0,v).forEach(t=>{let a=this.featuredJobCardTemplate.cloneNode(!0),n=a.querySelector(r.featuredJobTitle);n&&(n.textContent=t.title);let o=a.querySelector(r.featuredJobDesc);o&&(o.textContent=t.location.label);let d=a.querySelector(r.featuredJobCategory);d&&(d.textContent=t.department);let l=a.querySelector(r.featuredJobCta);l&&(l.href=t.postingUrl,l.target="_blank",l.rel="noopener noreferrer"),this.featuredJobList.appendChild(a)})}extractDepartments(){let e=new Set;this.jobs.forEach(t=>{t.department&&e.add(t.department)}),this.departments=Array.from(e).sort()}renderFilters(){if(!this.filtersWrapper||!this.filterTemplate)return;this.filtersWrapper.innerHTML="";let e=this.filterTemplate.cloneNode(!0),t=e.querySelector(r.filterText);t&&(t.textContent="View all"),e.classList.add("is-active"),e.addEventListener("click",()=>this.handleFilterClick(null,e)),this.filtersWrapper.appendChild(e),this.departments.forEach(a=>{let n=this.filterTemplate.cloneNode(!0),o=n.querySelector(r.filterText);o&&(o.textContent=a),n.classList.remove("is-active"),n.addEventListener("click",()=>this.handleFilterClick(a,n)),this.filtersWrapper.appendChild(n)})}handleFilterClick(e,t){this.filtersWrapper?.querySelectorAll(r.filterTag)?.forEach(n=>n.classList.remove("is-active")),t.classList.add("is-active"),this.applyFilter(e)}applyFilter(e){this.currentFilter=e,this.currentPage=1,e===null?this.filteredJobs=[...this.jobs]:this.filteredJobs=this.jobs.filter(t=>t.department===e),this.renderJobs(),this.renderPagination()}renderJobs(){if(!this.jobList||!this.jobCardTemplate)return;this.jobList.innerHTML="";let e=(this.currentPage-1)*5,t=e+5;this.filteredJobs.slice(e,t).forEach(n=>{let o=this.jobCardTemplate.cloneNode(!0),d=o.querySelector(r.jobTitle);d&&(d.textContent=n.title);let l=o.querySelector(r.jobDesc);l&&(l.textContent=n.location.label);let u=o.querySelector(r.jobCategory);u&&(u.textContent=n.department);let c=o.querySelector(r.jobCta);c&&(c.href=n.postingUrl,c.target="_blank",c.rel="noopener noreferrer"),this.jobList.appendChild(o)})}renderPagination(){if(!this.paginationWrapper||!this.pageBtnTemplate||!this.pageBtnWrapper)return;let e=Math.ceil(this.filteredJobs.length/5);this.filteredJobs.length<=5?this.paginationWrapper.classList.add("hide"):this.paginationWrapper.classList.remove("hide"),this.btnPrev&&(this.btnPrev.disabled=this.currentPage<=1,this.btnPrev.classList.toggle("is-disabled",this.currentPage<=1)),this.btnNext&&(this.btnNext.disabled=this.currentPage>=e,this.btnNext.classList.toggle("is-disabled",this.currentPage>=e)),this.pageBtnWrapper.innerHTML="";for(let t=1;t<=e;t++){let a=this.pageBtnTemplate.cloneNode(!0);a.textContent=String(t),a.classList.toggle("is-active",t===this.currentPage),a.addEventListener("click",()=>this.goToPage(t)),this.pageBtnWrapper.appendChild(a)}}goToPage(e){let t=Math.ceil(this.filteredJobs.length/5);e<1||e>t||(this.currentPage=e,this.renderJobs(),this.renderPagination(),this.jobList?.scrollIntoView({behavior:"smooth",block:"start"}))}async refresh(){await this.loadJobs()}};window.refreshJobBoard=null;window.Webflow||(window.Webflow=[]);window.Webflow.push(async()=>{if(document.querySelector('[dev-role="job-container"]')){let e=new p;await e.init(),window.refreshJobBoard=()=>e.refresh()}});})();
